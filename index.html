<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Spring-integration-java-dsl by manojp1988</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Spring-integration-java-dsl</h1>
      <h2 class="project-tagline"></h2>
      <a href="https://github.com/manojp1988/spring-integration" class="btn">View on GitHub</a>
      <a href="https://github.com/manojp1988/spring-integration/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/manojp1988/spring-integration/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h3>
<a id="welcome-to-my-github-spring-integration-java-dsl-repository" class="anchor" href="#welcome-to-my-github-spring-integration-java-dsl-repository" aria-hidden="true"><span class="octicon octicon-link"></span></a>Welcome to my Github Spring-integration-java-dsl repository!</h3>

<p>This repository contains samples, questions&amp;answers posted to spring-integration authors. Thanks to <a href="https://github.com/garyrussell" class="user-mention">@garyrussell</a> and <a href="https://github.com/artembilan" class="user-mention">@artembilan</a> for their support.</p>

<p><strong>Why dsl than xml?</strong></p>

<p>Java dsl is better in a way that we don't need to write complex xml integration tags, more writing to define each components. Java dsl is more reable, more resuable.</p>

<p>Reference: <a href="https://github.com/spring-projects/spring-integration-java-dsl/wiki/Spring-Integration-Java-DSL-Reference">Spring-Integration-Java-DSL-Reference</a>.</p>

<h4>
<a id="sample-flow" class="anchor" href="#sample-flow" aria-hidden="true"><span class="octicon octicon-link"></span></a>Sample Flow:</h4>

<p>A sample outbound gateway can have  transformer which transform the canonical object to request object, header enricher which enriches header values, and call the outbound gateway and then transform the response object to canonical response object. This can be code in below dsl way.</p>

<p><em>Java configuration</em></p>

<div class="highlight highlight-java"><pre>  @<span class="pl-smi">Configuration</span>
  @<span class="pl-smi">EnableIntegration</span> <span class="pl-c">// Enables integration infrastructure like channels.</span>
  @<span class="pl-smi">IntegrationComponentScan</span> <span class="pl-c">// Like component scan, this will scan integration components like @MessaginGateway etc.</span>
  @<span class="pl-smi">EnableMessageHistory</span> <span class="pl-c">// This enables adding message flow history in the header.</span>
  <span class="pl-k">public</span>  <span class="pl-k">class</span> <span class="pl-en">ContextConfiguration</span> {
  }</pre></div>

<p><em>Gateway:</em></p>

<div class="highlight highlight-java"><pre>  @<span class="pl-smi">MessagingGateway</span>
  <span class="pl-k">public</span> <span class="pl-k">interface</span> <span class="pl-en">HelloGateway</span> {
    <span class="pl-k">@Gateway</span>(<span class="pl-c1">requestChannel</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>helloRequestChannel<span class="pl-pds">"</span></span>)
    <span class="pl-smi">String</span> <span class="pl-en">sayHello</span>(<span class="pl-smi">String</span> <span class="pl-v">payload</span>);
  }</pre></div>

<p><em>Channel definition:</em></p>

<div class="highlight highlight-java"><pre> @<span class="pl-smi">Bean</span>
 <span class="pl-k">public</span> <span class="pl-smi">MessageChannel</span> helloRequestChannel(){
   <span class="pl-k">return</span> <span class="pl-smi">MessageChannels</span><span class="pl-k">.</span>direct()<span class="pl-k">.</span>get();
 }</pre></div>

<p><em>Integration flow:</em></p>

<div class="highlight highlight-java"><pre>  @<span class="pl-smi">Bean</span>
  <span class="pl-k">public</span> <span class="pl-smi">IntegrationFlow</span> sayHelloFlow(){
   <span class="pl-k">return</span> <span class="pl-smi">IntegrationFlow</span><span class="pl-k">.</span>from(<span class="pl-s"><span class="pl-pds">"</span>helloRequestChannel<span class="pl-pds">"</span></span>)
                         .transform(requestTransformer)
                         .enrichHeaders(headerEnricher)
                         .handle(httpOutboundGateway)
                         .transform(responseTransformer)
                         .get();
   }</pre></div>

<p><em>How to invoke the gateway</em></p>

<ol>
<li>Invoke through simple java invocation.</li>
<li>Put message into the channel.</li>
</ol>

<div class="highlight highlight-java"><pre>  sayHello(<span class="pl-s"><span class="pl-pds">"</span>dsl<span class="pl-pds">"</span></span>); <span class="pl-c">// Java method invocation.</span></pre></div>

<div class="highlight highlight-xml"><pre><span class="pl-c">&lt;!-- below enricher puts payload into the channel we defined above and sets into property as usual. --&gt;</span>
  &lt;<span class="pl-ent">int</span><span class="pl-ent">:</span><span class="pl-ent">enricher</span> <span class="pl-e">input-channel</span>=<span class="pl-s"><span class="pl-pds">"</span>HELLO_ENRCH_CHNL<span class="pl-pds">"</span></span>
        <span class="pl-e">request-channel</span>=<span class="pl-s"><span class="pl-pds">"</span>helloRequestChannel<span class="pl-pds">"</span></span>&gt;
        &lt;<span class="pl-ent">int</span><span class="pl-ent">:</span><span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span> <span class="pl-e">expression</span>=<span class="pl-s"><span class="pl-pds">"</span>payload.name<span class="pl-pds">"</span></span> /&gt;
    &lt;/<span class="pl-ent">int</span><span class="pl-ent">:</span><span class="pl-ent">enricher</span>&gt;</pre></div>

<p>Working example represents above can be found <a href="https://github.com/manojp1988/spring-integration/tree/master/javadsl/src/main/java/enrichPayload">here</a>.</p>

<p>If you see above, you can find the difference how dsl improves readability. Instead of we defining channels, spring generates channels for us. And you can see them if you enable logging.</p>

<h4>
<a id="debugging" class="anchor" href="#debugging" aria-hidden="true"><span class="octicon octicon-link"></span></a>Debugging.</h4>

<p>All channels are created based on the flow name we define. If you see from above example, spring generates sayHelloFlow.channel#0, sayHelloFlow.channel#1 etc. </p>

<h4>
<a id="examples" class="anchor" href="#examples" aria-hidden="true"><span class="octicon octicon-link"></span></a>Examples:</h4>

<ol>
<li> <a href="https://github.com/manojp1988/spring-integration/tree/master/javadsl/src/main/java/flow">Flow reuse.</a> This is something we wanted to achieve using dsl. With xml, we had to same kind of flow redundantly in many places. </li>
<li> <a href="https://github.com/manojp1988/spring-integration/tree/master/javadsl/src/main/java/advice">Advice for gateways.</a> We can ran aop on the gateways. This is not specific to dsl though.</li>
<li> <a href="https://github.com/manojp1988/spring-integration/tree/master/javadsl/src/main/java/interceptors">Global channel interceptors/</a>.</li>
<li> <a href="https://github.com/manojp1988/spring-integration/tree/master/javadsl/src/main/java/ErrorChannel">Re-route error channel to caller.</a>.</li>
<li> <a href="https://github.com/manojp1988/spring-integration/tree/master/javadsl/src/main/java/splitter_aggregator">Splitter-Aggregator</a><br>
</li>
<li> <a href="https://github.com/manojp1988/spring-integration/tree/master/javadsl/src/main/java/router/payload">Expression based router.</a>
</li>
<li> <a href="https://github.com/manojp1988/spring-integration/tree/master/javadsl/src/main/java/router/recipient">Recipient list router.</a>
</li>
<li> Header value router.</li>
</ol>

<p><em>More will come...</em></p>

<h4>
<a id="questions" class="anchor" href="#questions" aria-hidden="true"><span class="octicon octicon-link"></span></a>Questions:</h4>

<ol>
<li> <a href="http://stackoverflow.com/questions/31791042/how-to-put-back-errorchannel-message-into-reply-channel">How to put back errorchannel message into reply channel?</a>
</li>
<li> <a href="http://stackoverflow.com/questions/31778650/how-to-carry-over-header-info-to-errorchannel">How to carry over header info to errorChannel?</a>
</li>
<li> <a href="http://stackoverflow.com/questions/31707343/how-to-use-aop-on-spring-integration-gateways">How to use AOP on spring integration gateways?</a>
</li>
<li> <a href="http://stackoverflow.com/questions/31666328/how-to-import-spring-java-dsl-config-into-xml-configuration">How to import spring Java dsl config into XML configuration?</a>
</li>
<li> <a href="http://stackoverflow.com/questions/31631890/what-is-the-difference-between-grouping-config-via-import-and-contextconfigura">What is the difference between grouping config via @import and @ContextConfiguration.?</a>
</li>
<li> <a href="http://stackoverflow.com/questions/31626497/how-to-create-custom-component-and-add-it-to-flow-in-spring-java-dsl">How to create custom component and add it to flow in spring java dsl?</a>
</li>
<li> <a href="http://stackoverflow.com/questions/31617449/do-i-need-to-do-declare-a-channel-info-in-dsl-always">Do i need to do declare a channel info in dsl always?</a>
</li>
<li> <a href="http://stackoverflow.com/questions/31622120/how-to-do-split-aggregate-in-java-dsl-by-invoking-another-flow">How to do split-aggregate in java dsl by invoking another flow?</a>
</li>
<li> <a href="http://stackoverflow.com/questions/31573744/how-to-do-channel-interceptor-based-on-pattern-using-java-dsl-in-spring-integrat">How to do channel interceptor based on pattern using JAVA DSL in Spring Integration?</a>
</li>
</ol>

<div id="disqus_thread"></div>



Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/manojp1988/spring-integration">Spring-integration-java-dsl</a> is maintained by <a href="https://github.com/manojp1988">manojp1988</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

            <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-66020518-1");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

  </body>
</html>
